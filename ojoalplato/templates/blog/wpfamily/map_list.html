{% extends "blog/wpfamily/base.html" %}
{% load static %}
{% load leaflet_tags %}

{% block css %}
    {{ block.super }}
    {% leaflet_css %}
    <link href="{% static 'bower_components/Leaflet.awesome-markers/dist/leaflet.awesome-markers.css' %}"
          rel="stylesheet" type="text/css" media="all"/>
    <style>

        .leaflet-container { /* all maps */
            width: 100%;
            height: 500px;
            position: relative;
            background-color: white;
            overflow: hidden;
        }

        .content-area {
            padding-top: 20px;
            padding-left: 0;
            padding-right: 0;
            padding-bottom: 20px;
        }

        .has-family .content-area {
            padding-top: 160px;
        }

    </style>

{% endblock css %}

{% block javascript %}
    {{ block.super }}
    {% leaflet_js %}
    <script src="{% static 'bower_components/Leaflet.awesome-markers/dist/leaflet.awesome-markers.min.js' %}"
            type="text/javascript"></script>
    <script type="text/javascript">
        var restIcon = L.AwesomeMarkers.icon({
            icon: 'cutlery',
            markerColor: 'blue'
        });
        window.addEventListener("map:init", function (e) {
            var detail = e.detail;
            detail.map.scrollWheelZoom.disable();
            {% for rest in object_list %}
                L.marker({{ rest.get_position_wgs84 }}, {icon: restIcon}).addTo(detail.map)
                .bindPopup("<b>{{ rest.name }}</b> <br>\{% for post in rest.posts.all %}
                <a href='{{ post.get_absolute_url }}'>{{ post.title }}</a><br>\{% endfor %}
                ");
            {% endfor %}
        }, false);
    </script>
{% endblock javascript %}

{% block content %}
    <!--div id="map" style="position: relative; background-color: white; overflow: hidden; height: 300px; width: 100%;"></div-->
    {% leaflet_map "map" %}
{% endblock content %}
